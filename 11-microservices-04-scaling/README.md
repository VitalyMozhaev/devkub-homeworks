
# Ответы на домашнее задание к занятию "11.04 Микросервисы: масштабирование"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров;
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
- Обеспечивать возможность горизонтального масштабирования;
- Обеспечивать возможность автоматического масштабирования;
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.

## Ответ:

| Инструменты: | [K8S](https://kubernetes.io/) | [Docker Swarm](https://docs.docker.com/engine/swarm/) | [Nomad](https://www.nomadproject.io/) | [Apache Mesos](https://mesos.apache.org/) |
|:---|:---:|:---:|:---:|:---:|
| Поддержка контейнеров | есть | есть | есть | есть |
| Обеспечивать обнаружение сервисов и маршрутизацию запросов | есть | есть | через доп. инструмент Consul | есть |
| Обеспечивать возможность горизонтального масштабирования | есть | есть | есть | есть |
| Обеспечивать возможность автоматического масштабирования | есть | нет | есть | доступно в комбинации с Maraphon |
| Обеспечивать явное разделение ресурсов доступных извне и внутри системы | есть | нет | есть | есть |
| Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п. | есть | есть | через доп. инструмент Vault | через Vault или в платной версии DC/OS Enterprise, которая уже не развивается |

### Итого:

`Docker Swarm` уступает Kubernetes в плане администрирования, у него отсутствует автомасштабирование и маленькое сообщество.

`Nomad` имеет ограниченную функциональность, требуется установка сторонних инструментов для решения задач, которые K8s реализует по умолчанию: Autodiscovery, управление секретами. Кроме того, имеет меньшее сообщество.

`Apache Mesos` проще развернуть, чем Kubernetes, если мы говорим о ручной установке. Однако дальнейшее администрирование Apache Mesos сложнее по сравнению с K8s, так как необходимо работать с ZooKeeper, уметь администрировать Java и быть готовым к связанным с этим трудностям: утечкам памяти, Xmx, лимитам и так далее. Kubernetes с Golang в этом плане проще. Опять же, меньшая поддержка сообщества.

`Kubernetes` самодостаточный инструмент оркестровки, в который встроено множество сервисов, необходимых для запуска приложений на основе контейнеров, включая управление кластером, планирование, обнаружение служб, мониторинг, управление безопасностью и многое другое.
Самое большое сообщество среди всех оркестраторов, что обеспечивает богатый инструментарий и большое число готовых решений.
Это бесплатный инструмент с открытым исходным кодом, который работает в любой ОС.

Моё предложение - использовать Kubernetes.

## Задача 2: Распределенный кэш * (необязательная)

Разработчикам вашей компании понадобился распределенный кэш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster состоящий из трех шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)
